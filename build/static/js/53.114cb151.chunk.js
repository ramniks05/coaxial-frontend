"use strict";(self.webpackChunklearning_management_system=self.webpackChunklearning_management_system||[]).push([[53],{53:(e,s,r)=>{r.r(s),r.d(s,{default:()=>d});var t=r(555),a=r(43),i=r(580),n=r(872),c=r(712),o=(r(595),r(579));const l=e=>{let{item:s,itemType:r="item",onEdit:t,onDelete:a,fields:i=[],badges:n=[],structureTypes:c=[]}=e;const l=()=>s.description,d=()=>s.createdByName;return(0,o.jsxs)("div",{className:"data-card",children:[(0,o.jsxs)("div",{className:"card-header",children:[(0,o.jsxs)("div",{className:"card-title",children:[(0,o.jsx)("h4",{children:(()=>{switch(r){case"subject":return s.subjectName||s.name;case"topic":return s.topicName||s.name;default:return s.name}})()}),(0,o.jsxs)("div",{className:"card-badges",children:[(0,o.jsx)("span",{className:"status-badge ".concat(s.isActive?"active":"inactive"),children:s.isActive?"Active":"Inactive"}),n.map(e=>{var r;const{key:t,label:a,value:i,condition:n,style:l,icon:d}=e;if(n&&!n(s))return null;const u=i||s[t];if(!u)return null;let p=l,m=d;if("structureType"===t&&c.length>0){const e=c.find(e=>e.value===u);e&&(p={backgroundColor:e.color||"#666",color:"white"},m=e.icon)}return(0,o.jsxs)("span",{className:"structure-badge",style:p,title:"structureType"===t?null===(r=c.find(e=>e.value===u))||void 0===r?void 0:r.description:void 0,children:[m," ",u]},t)})]})]}),(0,o.jsxs)("div",{className:"card-actions",children:[(0,o.jsx)("button",{className:"btn btn-outline btn-xs",onClick:()=>{t&&t(s)},children:"Edit"}),(0,o.jsx)("button",{className:"btn btn-danger btn-xs",onClick:()=>{a&&a(s.id)},children:"Delete"})]})]}),(0,o.jsxs)("div",{className:"card-content",children:[l()&&(0,o.jsx)("p",{className:"description",children:l()}),i.map(e=>{const{key:r,label:t,value:a,condition:i}=e;if(i&&!i(s))return null;const n="function"===typeof a?a(s):a||s[r];return n?(0,o.jsxs)("p",{children:[(0,o.jsxs)("strong",{children:[t,":"]})," ",n]},r):null})]}),(0,o.jsx)("div",{className:"card-footer",children:(0,o.jsxs)("small",{className:"text-muted",children:["Created: ",new Date(s.createdAt).toLocaleDateString(),d()&&(0,o.jsxs)("span",{children:[" by ",d()]})]})})]})},d=()=>{var e;const{token:s,addNotification:r}=(0,i.nm)(),[d,u]=(0,a.useState)([]),[p,m]=(0,a.useState)(!1),[y,h]=(0,a.useState)(!1),[v,f]=(0,a.useState)(null),[x,g]=(0,a.useState)({name:"",description:"",structureType:"",displayOrder:0,isActive:!0}),j=(0,a.useRef)(!1),b=(0,a.useRef)(s);(0,a.useEffect)(()=>{b.current=s},[s]);const A=[{value:"ACADEMIC",label:"Academic",description:"CourseType \u2192 Course \u2192 Class \u2192 Subject \u2192 Topic \u2192 Module \u2192 Chapter",icon:"\ud83c\udfeb",color:"#4CAF50"},{value:"COMPETITIVE",label:"Competitive",description:"CourseType \u2192 Course \u2192 Exam \u2192 Subject \u2192 Topic \u2192 Module \u2192 Chapter",icon:"\ud83d\udcdd",color:"#FF9800"},{value:"PROFESSIONAL",label:"Professional",description:"CourseType \u2192 Course \u2192 Subject \u2192 Topic \u2192 Module \u2192 Chapter",icon:"\ud83d\udcbc",color:"#2196F3"},{value:"CUSTOM",label:"Custom",description:"Flexible structure based on requirements",icon:"\u2699\ufe0f",color:"#9C27B0"}];(0,a.useEffect)(()=>{if(j.current||!b.current)return;(async()=>{try{m(!0);const e=await(0,n.RG)(b.current);console.log("Raw API response:",e),console.log("Data type:",typeof e),console.log("Is array:",Array.isArray(e));let s=[];Array.isArray(e)?s=e:e&&Array.isArray(e.content)?s=e.content:e&&Array.isArray(e.data)?s=e.data:e&&e.courseTypes&&Array.isArray(e.courseTypes)?s=e.courseTypes:(console.warn("Unexpected data format:",e),s=[]),console.log("Processed course types array:",s),u(s),j.current=!0}catch(e){console.error("Error fetching course types:",e),r({type:"error",message:"Failed to fetch course types: ".concat(e.message),duration:7e3}),u([])}finally{m(!1)}})()},[]);const N=async()=>{if(b.current)try{m(!0);const e=await(0,n.RG)(b.current);console.log("Raw API response (refresh):",e),console.log("Data type:",typeof e),console.log("Is array:",Array.isArray(e));let s=[];Array.isArray(e)?s=e:e&&Array.isArray(e.content)?s=e.content:e&&Array.isArray(e.data)?s=e.data:e&&e.courseTypes&&Array.isArray(e.courseTypes)?s=e.courseTypes:(console.warn("Unexpected data format (refresh):",e),s=[]),console.log("Processed course types array (refresh):",s),u(s)}catch(e){console.error("Error fetching course types:",e),r({type:"error",message:"Failed to fetch course types: ".concat(e.message),duration:7e3}),u([])}finally{m(!1)}},C=e=>{g({name:e.name,description:e.description||"",structureType:e.structureType||"",displayOrder:e.displayOrder||0,isActive:e.isActive}),f(e.id),h(!0)},T=async e=>{if(window.confirm("Are you sure you want to delete this course type?"))try{m(!0),await(0,c.v0)(s,e),r({type:"success",message:"Course type deleted successfully",duration:3e3}),(0,n.K1)(),N()}catch(t){console.error("Error deleting course type:",t);let e="Failed to delete course type";t.message.includes("401")||t.message.includes("Unauthorized")?e="Authentication required. Please login first or implement backend authentication.":t.message.includes("cascade")&&(e="Cannot delete course type due to existing relationships. Please remove related data first."),r({type:"error",message:e,duration:5e3})}finally{m(!1)}},w=()=>{g({name:"",description:"",structureType:"",displayOrder:0,isActive:!0}),f(null),h(!1)};return(0,o.jsxs)("div",{className:"master-data-component",children:[(0,o.jsxs)("div",{className:"component-header",children:[(0,o.jsxs)("div",{className:"header-info",children:[(0,o.jsx)("h2",{children:"Course Type Management"}),(0,o.jsx)("p",{children:"Manage different types of courses with their hierarchical structures (Academic, Competitive, Professional, Custom)"})]}),(0,o.jsx)("div",{className:"header-actions",children:(0,o.jsx)("button",{className:"btn btn-primary",onClick:()=>h(!0),disabled:p,children:"Add Course Type"})})]}),y&&(0,o.jsxs)("div",{className:"form-section",children:[(0,o.jsxs)("div",{className:"form-header",children:[(0,o.jsx)("h3",{children:v?"Edit Course Type":"Add New Course Type"}),(0,o.jsx)("button",{className:"btn btn-outline btn-sm",onClick:w,children:"Cancel"})]}),(0,o.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{if(m(!0),!x.name||!x.name.trim())return void r({type:"error",message:"Course type name is required",duration:5e3});if(!x.structureType)return void r({type:"error",message:"Structure type is required",duration:5e3});const e={name:x.name.trim(),description:x.description?x.description.trim():"",structureType:x.structureType,displayOrder:x.displayOrder||0,isActive:x.isActive};v&&(e.id=v),delete e.courses,delete e.subjects,console.log("Form data being submitted:",e),console.log("Token available:",!!s),v?(await(0,c.N2)(s,v,e),r({type:"success",message:"Course type updated successfully",duration:3e3})):(await(0,c.EV)(s,e),r({type:"success",message:"Course type created successfully",duration:3e3})),h(!1),f(null),g({name:"",description:"",isActive:!0}),(0,n.K1)(),N()}catch(t){console.error("Error saving course type:",t);let e="Failed to save course type";e=t.message.includes("401")||t.message.includes("Unauthorized")?"Authentication required. Please login first or implement backend authentication.":t.message.includes("cascade")?"Course type update failed due to relationship constraints. Please try again or contact support.":t.message.includes("500")?"Server error occurred while saving course type. Please try again.":t.message.includes("400")?"Invalid data provided. Please check your input and try again.":"Failed to save course type: ".concat(t.message),r({type:"error",message:e,duration:5e3})}finally{m(!1)}},className:"master-data-form",children:[(0,o.jsxs)("div",{className:"form-row",children:[(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"name",children:"Course Type Name *"}),(0,o.jsx)("input",{type:"text",id:"name",name:"name",value:x.name,onChange:e=>g((0,t.A)((0,t.A)({},x),{},{name:e.target.value})),className:"form-input",required:!0,placeholder:"e.g., Academic, Professional, Certification"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"displayOrder",children:"Display Order"}),(0,o.jsx)("input",{type:"number",id:"displayOrder",name:"displayOrder",value:x.displayOrder,onChange:e=>g((0,t.A)((0,t.A)({},x),{},{displayOrder:parseInt(e.target.value)||0})),className:"form-input",min:"0",placeholder:"0"})]})]}),(0,o.jsxs)("div",{className:"form-row",children:[(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"structureType",children:"Structure Type *"}),(0,o.jsxs)("select",{id:"structureType",name:"structureType",value:x.structureType,onChange:e=>g((0,t.A)((0,t.A)({},x),{},{structureType:e.target.value})),className:"form-input",required:!0,children:[(0,o.jsx)("option",{value:"",children:"Select Structure Type"}),A.map(e=>(0,o.jsxs)("option",{value:e.value,children:[e.icon," ",e.label]},e.value))]})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"isActive",children:"Status"}),(0,o.jsxs)("select",{id:"isActive",name:"isActive",value:x.isActive,onChange:e=>g((0,t.A)((0,t.A)({},x),{},{isActive:"true"===e.target.value})),className:"form-input",children:[(0,o.jsx)("option",{value:!0,children:"Active"}),(0,o.jsx)("option",{value:!1,children:"Inactive"})]})]})]}),x.structureType&&(0,o.jsxs)("div",{className:"form-section structure-preview",children:[(0,o.jsx)("h4",{children:"\ud83d\udccb Structure Preview"}),(0,o.jsx)("div",{className:"structure-flow",style:{padding:"12px",background:"#f8f9fa",border:"1px solid #e9ecef",borderRadius:"6px",color:"#495057",fontFamily:"monospace",fontSize:"0.9rem"},children:null===(e=A.find(e=>e.value===x.structureType))||void 0===e?void 0:e.description})]}),(0,o.jsx)("div",{className:"form-row",children:(0,o.jsxs)("div",{className:"form-group full-width",children:[(0,o.jsx)("label",{htmlFor:"description",children:"Description"}),(0,o.jsx)("textarea",{id:"description",name:"description",value:x.description,onChange:e=>g((0,t.A)((0,t.A)({},x),{},{description:e.target.value})),className:"form-input",placeholder:"Brief description of this course type",rows:3})]})}),(0,o.jsxs)("div",{className:"form-actions",children:[(0,o.jsx)("button",{type:"button",className:"btn btn-outline",onClick:w,children:"Cancel"}),(0,o.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?"Saving...":v?"Update Course Type":"Create Course Type"})]})]})]}),(0,o.jsxs)("div",{className:"data-section",children:[(0,o.jsxs)("div",{className:"data-header",children:[(0,o.jsxs)("h3",{children:["Course Types (",d.length,")"]}),(0,o.jsx)("div",{className:"data-actions",children:(0,o.jsx)("button",{className:"btn btn-outline btn-sm",onClick:N,disabled:p,children:"Refresh"})})]}),p?(0,o.jsxs)("div",{className:"loading-state",children:[(0,o.jsx)("div",{className:"loading-spinner"}),(0,o.jsx)("p",{children:"Loading course types..."})]}):0===d.length?(0,o.jsxs)("div",{className:"empty-state",children:[(0,o.jsx)("div",{className:"empty-icon",children:"\ud83d\udcda"}),(0,o.jsx)("h4",{children:"No Course Types Found"}),(0,o.jsx)("p",{children:"Create your first course type to get started"}),(0,o.jsx)("button",{className:"btn btn-primary",onClick:()=>h(!0),children:"Add Course Type"})]}):(0,o.jsx)("div",{className:"data-grid",children:d.map(e=>{const s=[{key:"displayOrder",label:"Display Order",condition:e=>null!==e.displayOrder&&void 0!==e.displayOrder}];return(0,o.jsx)(l,{item:e,itemType:"courseType",onEdit:C,onDelete:T,fields:s,badges:[{key:"structureType",label:"Structure Type",condition:e=>e.structureType}],structureTypes:A},e.id)})})]})]})}}}]);
//# sourceMappingURL=53.114cb151.chunk.js.map